<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Z.A.M.">





<title>MongoDB | Z. A. M.’s Blog</title>



    <link rel="icon" href="/taiaiac.gitee.io/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/taiaiac.gitee.io/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/taiaiac.gitee.io/js/script.js"></script>
    
    <script src="/taiaiac.gitee.io/js/tocbot.min.js"></script>
    



    
    
        
    


  <meta name="generator" content="Hexo 5.3.0"></head>
  <body>
    <div class="wrapper">
      <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/taiaiac.gitee.io/">TaiAiAc&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/taiaiac.gitee.io/archives">文档</a>
                
                    <a class="menu-item" href="/taiaiac.gitee.io/category">分类</a>
                
                    <a class="menu-item" href="/taiaiac.gitee.io/tag">标签</a>
                
                    <a class="menu-item" href="/taiaiac.gitee.io/about">关于</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/taiaiac.gitee.io/">TaiAiAc&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/taiaiac.gitee.io/archives">文档</a>
                
                    <a class="menu-item" href="/taiaiac.gitee.io/category">分类</a>
                
                    <a class="menu-item" href="/taiaiac.gitee.io/tag">标签</a>
                
                    <a class="menu-item" href="/taiaiac.gitee.io/about">关于</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
      <div class="main"><div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">MongoDB</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Z.A.M.</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">一月 13, 2021&nbsp;&nbsp;10:35:31</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/taiaiac.gitee.io/categories/NodeJS/">NodeJS</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h1><h2 id="1-关系型和非关系型数据库"><a href="#1-关系型和非关系型数据库" class="headerlink" title="1.关系型和非关系型数据库"></a>1.关系型和非关系型数据库</h2><h3 id="关系型数据库（表就是关系，或者说表与表之间存在关系）"><a href="#关系型数据库（表就是关系，或者说表与表之间存在关系）" class="headerlink" title="关系型数据库（表就是关系，或者说表与表之间存在关系）"></a>关系型数据库（表就是关系，或者说表与表之间存在关系）</h3><ul>
<li>所有的关系型数据库都需要通过<code>sql</code>语言来操作</li>
<li>所有的关系型数据库在操作之前都需要设计表结构</li>
<li>而且数据表还支持约束<ul>
<li>唯一的</li>
<li>主键</li>
<li>默认值</li>
<li>非空</li>
</ul>
</li>
</ul>
<h3 id="非关系型数据库"><a href="#非关系型数据库" class="headerlink" title="非关系型数据库"></a>非关系型数据库</h3><ul>
<li>非关系型数据库非常的灵活</li>
<li>有的关系型数据库就是 key-value 对</li>
<li>但 MongDB 是长得最像关系型数据库的非关系型数据库<ul>
<li>数据库 -》 数据库</li>
<li>数据表 -》 集合（数组）</li>
<li>表记录 -》文档对象</li>
</ul>
</li>
<li>一个数据库中可以有多个数据库</li>
<li>一个数据库中可以有多个集合（数组）</li>
<li>一个集合中可以有多个文档（表记录）</li>
<li>文档解构很灵活，没有任何限制</li>
<li>mongoDB 非常灵活，不需要像 MySQL 一样先创建数据库、表、设计表结构<ul>
<li>当你需要插入数据的时候，只需要指定往那个数据库的哪个集合操作就可以了</li>
<li>一切都有 MongoDB 来帮你自动完成建库建表。。</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    qq:&#123;</span><br><span class="line">       user:[</span><br><span class="line">           &#123;&#125;,&#123;&#125;,&#123;&#125;...</span><br><span class="line">       ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>也就是说你可以任意的往里面存数据，没有结构性这么一说</li>
</ul>
<h3 id="存储结构"><a href="#存储结构" class="headerlink" title="存储结构"></a>存储结构</h3><ul>
<li>一个计算机上可以有一个数据库服务实例</li>
<li>一个数据服务实例上可以有多个数据库</li>
<li>一个数据库中可以有多个集合<ul>
<li>集合根据数据的业务类型划分</li>
<li>例如用户数据、商品信息数据、广告信息数据。。。</li>
<li>对数据进行分门别类的存储</li>
<li>集合在 MongoDB 中就类似于数组</li>
</ul>
</li>
<li>一个集合中可以有多个文档<ul>
<li>文档在 MongoDB 中就是一个 类似于 JSON 的数据对象</li>
<li>文档对象是动态的，可以随意的生成</li>
<li>为了便于管理，最好一个集合中存储的数据一定要保持文档结构的统一（数据完整性）</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  collection1: [</span><br><span class="line">    &#123; a: &#123; age: 18, name: &#x27;&#x27;, lsit: [], is: true &#125; &#125;,</span><br><span class="line">    &#123; 文档2 &#125;,</span><br><span class="line">    &#123; 文档3 &#125;</span><br><span class="line">  ],</span><br><span class="line">  collection2: [],</span><br><span class="line">  collection3: [],</span><br><span class="line">  collection4: [],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h2><ul>
<li><p>下载</p>
<ul>
<li>下载地址：<a target="_blank" rel="noopener" href="https://www.mongodb.com/download-center/community">https://www.mongodb.com/download-center/community</a></li>
</ul>
</li>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mongoose</span><br></pre></td></tr></table></figure></li>
<li><p>配置环境变量</p>
</li>
<li><p>最后输入<code>mongod --version</code>测试是否安装成功</p>
</li>
</ul>
<h2 id="3-启动和关闭数据库"><a href="#3-启动和关闭数据库" class="headerlink" title="3.启动和关闭数据库"></a>3.启动和关闭数据库</h2><p>启动：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> mongodb 默认使用执行mongod 命令所处盼复根目录下的/data/db作为自己的数据存储目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 所以在第一次执行该命令之前先自己手动新建一个 /data/db</span></span><br><span class="line">mongod</span><br></pre></td></tr></table></figure>
<p>如果想要修改默认的数据存储目录，可以：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath = 数据存储目录路径</span><br></pre></td></tr></table></figure>
<p>停止：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在开启服务的控制台，直接Ctrl+C;</span><br><span class="line">或者直接关闭开启服务的控制台。</span><br></pre></td></tr></table></figure>
<h2 id="4-连接数据库"><a href="#4-连接数据库" class="headerlink" title="4.连接数据库"></a>4.连接数据库</h2><p>连接：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 该命令默认连接本机的 MongoDB 服务</span></span><br><span class="line">mongo</span><br></pre></td></tr></table></figure>
<p>退出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在连接状态输入 <span class="built_in">exit</span> 退出连接</span></span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<h2 id="5-基本命令"><a href="#5-基本命令" class="headerlink" title="5.基本命令"></a>5.基本命令</h2><ul>
<li><p><code>show dbs</code></p>
<ul>
<li>查看数据库列表(数据库中的所有数据库)</li>
</ul>
</li>
<li><p><code>db</code></p>
</li>
<li><p>查看当前连接的数据库</p>
</li>
<li><p><code>use 数据库名称</code></p>
<ul>
<li>切换到指定的数据库，（如果没有会新建）</li>
</ul>
</li>
<li><p>插入数据</p>
</li>
<li><p><code>show collections</code></p>
</li>
<li><p>查看当前目录下的所有数据表</p>
</li>
<li><p><code>db.表名.find()</code></p>
<ul>
<li>查看表中的详细信息</li>
</ul>
</li>
<li><p><code>db.createCollection(&#39;student&#39;)</code></p>
<ul>
<li>创建</li>
</ul>
</li>
<li><p><code>db.student.find().pretty()</code></p>
<ul>
<li>查询转化json字符串</li>
</ul>
</li>
<li><p><code>db.student.distinct(&#39;条件&#39;)</code></p>
<ul>
<li>去重</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#39;age&#39;:18&#125;)</code></p>
<ul>
<li>条件查询{‘age’:18}</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#39;age&#39;:&#123;&quot;$lt&quot;:18&#125;&#125;)</code></p>
<ul>
<li>小于18</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#39;age&#39;:&#123;&quot;$gt&quot;:18&#125;&#125;)</code></p>
<ul>
<li>大于18</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#39;age&#39;:&#123;&quot;$lte&quot;:18&#125;&#125;)</code></p>
<ul>
<li>等于18</li>
</ul>
</li>
<li><p><code> db.student.find(&#123;&#39;age&#39;:&#123;&quot;$lt&quot;:18,&quot;$lte&quot;:12&#125;&#125;)</code></p>
<ul>
<li>小于18等于12</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#125;,&#123;&#39;name&#39;:1,&#39;age&#39;:1,&quot;_id&quot;:0&#125;)</code></p>
<ul>
<li>字段查询(包含)</li>
<li>“_id”:0 去除查询结果中的id</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;$or:[&#123;&#39;name&#39;:&#39;zs&#39;,&#39;age&#39;:18&#125;]&#125;)</code></p>
<ul>
<li>查询全部</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;$or:[&#123;&#39;name&#39;:&#39;zs&#39;,&#39;age&#39;:18&#125;]&#125;).limit(1)</code></p>
<ul>
<li>限制条数</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#39;age&#39;:&#123;&#39;$ne&#39;:18&#125;&#125;)</code></p>
<ul>
<li>不等于18</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#125;).count()</code></p>
<ul>
<li>查询的条数</li>
</ul>
</li>
<li><p><code>db.student.find(&#123;&#125;).limit(2).skip(4)</code></p>
<ul>
<li>第4条数据开始查询</li>
</ul>
</li>
<li><p><code>db.student.update(&#123;&#39;name&#39;:&#39;zs&#39;&#125;,&#123;$set:&#123;&#39;age&#39;:30&#125;&#125;)</code></p>
<ul>
<li>只修改第一条数据</li>
</ul>
</li>
<li><p><code>db.student.updateOne(&#123;&#39;name&#39;:&#39;zs&#39;&#125;,&#123;$set:&#123;&#39;sex&#39;:&#39;female&#39;&#125;&#125;)</code></p>
<ul>
<li>修改单个</li>
</ul>
</li>
<li><p><code> db.student.updateMany(&#123;&#39;name&#39;:&#39;zs&#39;&#125;,&#123;$set:&#123;&#39;sex&#39;:&#39;female&#39;&#125;&#125;)</code></p>
<ul>
<li>修改多个</li>
</ul>
</li>
<li><p><code> db.student.deleteOne(&#123;&#125;)</code></p>
<ul>
<li>删除一个</li>
</ul>
</li>
<li><p><code>db.student.deleteMany(&#123;条件&#125;)</code></p>
<ul>
<li>删除查询的条件</li>
</ul>
</li>
</ul>
<h2 id="6-在-Node-中如何操作-MongoDB-数据库"><a href="#6-在-Node-中如何操作-MongoDB-数据库" class="headerlink" title="6.在 Node 中如何操作 MongoDB 数据库"></a>6.在 Node 中如何操作 MongoDB 数据库</h2><h3 id="使用官方的MongoDB-包来操作"><a href="#使用官方的MongoDB-包来操作" class="headerlink" title="使用官方的MongoDB 包来操作"></a>使用官方的<code>MongoDB</code> 包来操作</h3><blockquote>
<p> <a target="_blank" rel="noopener" href="http://mongodb.github.io/node-mongodb-native/">http://mongodb.github.io/node-mongodb-native/</a></p>
</blockquote>
<h3 id="使用第三方包-mongoose-来操作-MongoDB-数据库"><a href="#使用第三方包-mongoose-来操作-MongoDB-数据库" class="headerlink" title="使用第三方包 mongoose 来操作 MongoDB 数据库"></a>使用第三方包 <code>mongoose</code> 来操作 MongoDB 数据库</h3><p>第三方包：<code>mongoose</code>基于 MongoDB 官方的<code>mongodb</code>包再一次做了封装，名字叫<code>mongoose</code>，是 WordPress 项目团队开发的。</p>
<blockquote>
<p> <a target="_blank" rel="noopener" href="https://mongoosejs.com/">https://mongoosejs.com/</a></p>
</blockquote>
<h2 id="7-学习指南（步骤）"><a href="#7-学习指南（步骤）" class="headerlink" title="7.学习指南（步骤）"></a>7.学习指南（步骤）</h2><blockquote>
<p>官方学习文档：<a target="_blank" rel="noopener" href="http://www.mongoosejs.net/">http://www.mongoosejs.net/</a></p>
</blockquote>
<h3 id="设计-Scheme-发布-Model-（创建表）"><a href="#设计-Scheme-发布-Model-（创建表）" class="headerlink" title="设计 Scheme 发布 Model （创建表）"></a>设计 Scheme 发布 Model （创建表）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.引包</span></span><br><span class="line"><span class="comment">// 注意：按照后才能require使用</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 拿到schema图表</span></span><br><span class="line"><span class="keyword">var</span> Schema = mongoose.Schema</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.连接数据库</span></span><br><span class="line"><span class="comment">// 指定连接数据库后不需要存在，当你插入第一条数据库后会自动创建数据库</span></span><br><span class="line">mongoose.connect(<span class="string">&#x27;mongodb://localhost/test&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.设计集合结构（表结构）</span></span><br><span class="line"><span class="comment">// 用户表</span></span><br><span class="line"><span class="keyword">var</span> userSchema = <span class="keyword">new</span> Schema(&#123;</span><br><span class="line">  username: &#123;</span><br><span class="line">    <span class="comment">//姓名</span></span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span>, <span class="comment">//添加约束，保证数据的完整性，让数据按规矩统一</span></span><br><span class="line">  &#125;,</span><br><span class="line">  password: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  email: &#123;</span><br><span class="line">    type: <span class="built_in">String</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.将文档结构发布为模型</span></span><br><span class="line"><span class="comment">// mongoose.model方法就是用来将一个架构发布为 model</span></span><br><span class="line"><span class="comment">// 		第一个参数：传入一个大写名词单数字符串用来表示你的数据库的名称</span></span><br><span class="line"><span class="comment">// 					mongoose 会自动将大写名词的字符串生成 小写复数 的集合名称</span></span><br><span class="line"><span class="comment">// 					例如 这里会变成users集合名称</span></span><br><span class="line"><span class="comment">// 		第二个参数：架构</span></span><br><span class="line"><span class="comment">// 	返回值：模型构造函数</span></span><br><span class="line"><span class="keyword">var</span> User = mongoose.model(<span class="string">&#x27;User&#x27;</span>, userSchema)</span><br></pre></td></tr></table></figure>
<h3 id="添加（增）"><a href="#添加（增）" class="headerlink" title="添加（增）"></a>添加（增）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5.通过模型构造函数对User中的数据进行操作</span></span><br><span class="line"><span class="keyword">var</span> user = <span class="keyword">new</span> User(&#123;</span><br><span class="line">  username: <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">  password: <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">  email: <span class="string">&#x27;xiaochen@qq.com&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">user.save(<span class="function"><span class="keyword">function</span> (<span class="params">err, ret</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;保存失败&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;保存成功&#x27;</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="删除（删）"><a href="#删除（删）" class="headerlink" title="删除（删）"></a>删除（删）</h3><p>根据条件删除所有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">User.remove(</span><br><span class="line">  &#123;</span><br><span class="line">    username: <span class="string">&#x27;xiaoxiao&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err, ret</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;删除失败&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;删除成功&#x27;</span>)</span><br><span class="line">      <span class="built_in">console</span>.log(ret)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>根据条件删除一个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Model.findOneAndRemove(conditions,[options],[callback]);</span><br></pre></td></tr></table></figure>
<p>根据 id 删除一个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.findByIdAndRemove(id,[options],[callback]);</span><br></pre></td></tr></table></figure>
<h3 id="更新（改）"><a href="#更新（改）" class="headerlink" title="更新（改）"></a>更新（改）</h3><p>更新所有：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.remove(conditions,doc,[options],[callback]);</span><br></pre></td></tr></table></figure>
<p>根据指定条件更新一个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User.FindOneAndUpdate([conditions],[update],[options],[callback]);</span><br></pre></td></tr></table></figure>
<p>根据 id 更新一个：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新	根据id来修改表数据</span></span><br><span class="line">User.findByIdAndUpdate(</span><br><span class="line">  <span class="string">&#x27;5e6c5264fada77438c45dfcd&#x27;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    username: <span class="string">&#x27;junjun&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err, ret</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;更新失败&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;更新成功&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="查询（查）"><a href="#查询（查）" class="headerlink" title="查询（查）"></a>查询（查）</h3><p>查询所有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询所有</span></span><br><span class="line">User.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, ret</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;查询失败&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>条件查询所有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据条件查询</span></span><br><span class="line">User.find(&#123; <span class="attr">username</span>: <span class="string">&#x27;xiaoxiao&#x27;</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, ret</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;查询失败&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(ret)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>条件查询单个：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按照条件查询单个，查询出来的数据是一个对象（&#123;&#125;）</span></span><br><span class="line"><span class="comment">// 没有条件查询使用findOne方法，查询的是表中的第一条数据</span></span><br><span class="line">User.findOne(</span><br><span class="line">  &#123;</span><br><span class="line">    username: <span class="string">&#x27;xiaoxiao&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err, ret</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;查询失败&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(ret)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>与 findOne 相同，但它接收文档的 _id 作为参数，返回单个文档。_id 可以是字符串或 ObjectId 对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">User.findById(req.params.Id, <span class="function">(<span class="params">err, result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> next(err)</span><br><span class="line">    &#125;</span><br><span class="line">    res.json(&#123;</span><br><span class="line">      err_code: <span class="number">0</span>,</span><br><span class="line">      result: result</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

        </div>

        
            <section class="post-copyright">
                
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="#">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/taiaiac.gitee.io/tags/NodeJS/"># NodeJS</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/taiaiac.gitee.io/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/taiaiac.gitee.io/2021/01/13/Node.js/node%E4%B8%AD%E4%BD%BF%E7%94%A8MySQL/">node中使用MySQL</a>
            
            
            <a class="next" rel="next" href="/taiaiac.gitee.io/2021/01/13/Node.js/Express%E4%B8%AD%E9%97%B4%E4%BB%B6/">Express中间件</a>
            
        </section>


    </article>
</div>
</div>
      <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Z.A.M. | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
    <script
      type="text/javascript"
      color="96,98,102"
      opacity="0.7"
      zIndex="-2"
      count="99"
      src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"
    ></script>
  <script src="/taiaiac.gitee.io/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/taiaiac.gitee.io/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":200,"height":434},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body>
</html>
